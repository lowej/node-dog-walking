angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(e){e.$on("login",function(o,t){e.currentUser=t})}]),angular.module("app").directive("moDateInput",["$window",function(e){return{require:"^ngModel",restrict:"A",link:function(o,t,n,r){var a=e.moment,l=n.moMediumDate;n.$observe("moDateInput",function(e){l!=e&&r.$modelValue&&(l=e,r.$modelValue=new Date(r.$setViewValue))}),r.$formatters.unshift(function(e){if(o=o,!l||!e)return"";var t=a(e).format(l);return t}),r.$parsers.unshift(function(e){o=o;var t=a(e,l);return t&&t.isValid()&&t.year()>1950?t.toDate():""})}}}]),angular.module("app").directive("moChangeProxy",["$parse",function(e){return console.log("Inside moChangeProxy"),{require:"^ngModel",restrict:"A",link:function(o,t,n,r){var a=n.moChangeProxy,l=n.ngModel;o.$watch(a,function(t){t!=r.$modelValue&&e(l).assign(o,t)}),t.bind("blur",function(){var t=o.$eval(a);r.$modelValue!=t&&o.$apply(function(){e(a).assign(o,r.$modelValue)})})}}}]),angular.module("app").controller("DogsCtrl",["$window","$scope","DogsSvc",function(e,o,t){t.fetch().success(function(e){console.log("Total Number of dogs is: "+e.length),o.dogs=e}).error(function(){console.log("An error occured, so redirecting to login page"),e.location.href="/#/login"})}]),angular.module("app").controller("CreateCtrl",["$window","$scope","DogCreationSvc",function(e,o,t){o.addDog=function(){console.log("Just adding a dog"),console.log("$scope.dogStartDate"+o.dogStartDate),o.dogName&&t.create({dogName:o.dogName,ownerFirstName:o.ownerFirstName,ownerLastName:o.ownerSurname,dogDOB:o.dogDOB,dogStartDate:o.dogStartDate,dogPicture:o.image}).success(function(o){e.location.href="/#/"}).error(function(){console.log("An error occured, so redirecting to login page"),e.location.href="/#/login"})}}]),angular.module("app").controller("UploadCtrl",["$scope",function(e){e.image=""}]).directive("myUpload",[function(){return{restrict:"A",link:function(e,o,t){var n=new FileReader;n.onload=function(o){e.image=o.target.result,e.$apply()},o.on("change",function(){n.readAsDataURL(o[0].files[0])})}}}]),angular.module("app").controller("EditCtrl",["$window","$location","$scope","DogsGetOneSvc","DogsUpdateSvc",function(e,o,t,n,r){var a=!1,l=o.search();n.fetch(l.dogName).success(function(e){t.dog=e}),t.addNewWalk=function(){a=!0;var e=t.dog.walks.walkArray.length,o=new Date;t.dog.walks.walkArray.push({walkDate:o,walkTime:"60"}),console.log("adding a new walk, now have: "+(e+1))},t.removeWalk=function(e){a=!0,console.log("Going to remove walk from list at position: "+e),t.dog.walks.walkArray.splice(e,1)},t.hasUpdatedWalk=function(){return a},t.getRowColour=function(){return 1==a?{"background-color":"pink"}:{color:"blue"}},t.saveWalks=function(){console.log("Need to save the walks for dog: "+t.dog.dogName),r.update(t.dog).success(function(e){t.dog=e}).success(function(o){e.location.href="/#/"})}}]),angular.module("app").controller("DeleteCtrl",["$location","$scope","DogsDeleteSvc",function(e,o,t){var n=e.search();t["delete"](n.dogId).success(function(e){o.dog=e})}]),angular.module("app").service("DogsSvc",["$http",function(e){this.fetch=function(){return e.get("/api/dogs")}}]),angular.module("app").service("DogCreationSvc",["$http",function(e){this.create=function(o){return e.post("/api/dog",o)}}]),angular.module("app").service("DogsGetOneSvc",["$http",function(e){this.fetch=function(o){return console.log("Inside the angular service layer.  Have been asked to get dog: "+o),e({url:"/api/dog",method:"GET",params:{dogNameParam:o}})}}]),angular.module("app").service("DogsDeleteSvc",["$http",function(e){this["delete"]=function(o){return console.log("Inside the angular service layer.  Have been asked to delete dog: "+o),e({url:"/api/dog",method:"DELETE",params:{dogIdParam:o}})}}]),angular.module("app").service("DogsUpdateSvc",["$http",function(e){this.update=function(o){return console.log("Inside the angular service layer.  Have been asked to save dog: "+o.dogName),e({url:"/api/dog/"+o._id,method:"PUT",data:o})}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(e,o){var t=!1;e.login=function(t,n){o.login(t,n).then(function(o){e.$emit("login",o.data)})},e.getTextColour=function(){return 1==t?{"background-color":"pink"}:{"background-color":"white"}}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"DogsCtrl",templateUrl:"dogList.html"}).when("/createDog",{controller:"CreateCtrl",templateUrl:"dogCreation.html"}).when("/editDog",{controller:"EditCtrl",templateUrl:"dogEdit.html"}).when("/deleteDog",{controller:"DeleteCtrl",templateUrl:"dogList.html"}).when("/updateDog",{controller:"UpdateCtrl",templateUrl:"dogList.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(e){var o=this;o.getUser=function(){return e.get("/api/users")},o.login=function(t,n){return e.post("/api/sessions",{username:t,password:n}).then(function(t){return o.token=t.data,e.defaults.headers.common["X-Auth"]=t.data,o.getUser()})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJkb2dzLmN0cmwuanMiLCJkb2dzLnN2Yy5qcyIsImxvZ2luLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwicmVxdWlyZSIsInJlc3RyaWN0IiwibGluayIsInNjb3BlIiwiZWxtIiwiYXR0cnMiLCJjdHJsIiwibW9tZW50IiwiZGF0ZUZvcm1hdCIsIm1vTWVkaXVtRGF0ZSIsIiRvYnNlcnZlIiwibmV3VmFsdWUiLCIkbW9kZWxWYWx1ZSIsIkRhdGUiLCIkc2V0Vmlld1ZhbHVlIiwiJGZvcm1hdHRlcnMiLCJ1bnNoaWZ0IiwibW9kZWxWYWx1ZSIsInJldFZhbCIsImZvcm1hdCIsIiRwYXJzZXJzIiwidmlld1ZhbHVlIiwiZGF0ZSIsImlzVmFsaWQiLCJ5ZWFyIiwidG9EYXRlIiwiJHBhcnNlIiwiY29uc29sZSIsImxvZyIsInByb3h5RXhwIiwibW9DaGFuZ2VQcm94eSIsIm1vZGVsRXhwIiwibmdNb2RlbCIsIiR3YXRjaCIsIm5WYWwiLCJhc3NpZ24iLCJiaW5kIiwicHJveHlWYWwiLCIkZXZhbCIsIiRhcHBseSIsIkRvZ3NTdmMiLCJmZXRjaCIsInN1Y2Nlc3MiLCJkb2dzIiwibGVuZ3RoIiwiZXJyb3IiLCJsb2NhdGlvbiIsImhyZWYiLCJEb2dDcmVhdGlvblN2YyIsImFkZERvZyIsImRvZ1N0YXJ0RGF0ZSIsImRvZ05hbWUiLCJjcmVhdGUiLCJvd25lckZpcnN0TmFtZSIsIm93bmVyTGFzdE5hbWUiLCJvd25lclN1cm5hbWUiLCJkb2dET0IiLCJkb2dQaWN0dXJlIiwiaW1hZ2UiLCJkb2ciLCJlbGVtIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsImUiLCJ0YXJnZXQiLCJyZXN1bHQiLCJvbiIsInJlYWRBc0RhdGFVUkwiLCJmaWxlcyIsIiRsb2NhdGlvbiIsIkRvZ3NHZXRPbmVTdmMiLCJEb2dzVXBkYXRlU3ZjIiwid2Fsa3NBcmVFZGl0ZWQiLCJzZWFyY2hPYmplY3QiLCJzZWFyY2giLCJhZGROZXdXYWxrIiwiY3VycmVudFdhbGtDb3VudCIsIndhbGtzIiwid2Fsa0FycmF5IiwidG9kYXkiLCJwdXNoIiwid2Fsa0RhdGUiLCJ3YWxrVGltZSIsInJlbW92ZVdhbGsiLCJpbmRleCIsInNwbGljZSIsImhhc1VwZGF0ZWRXYWxrIiwiZ2V0Um93Q29sb3VyIiwiYmFja2dyb3VuZC1jb2xvciIsImNvbG9yIiwic2F2ZVdhbGtzIiwidXBkYXRlIiwiRG9nc0RlbGV0ZVN2YyIsImRvZ0lkIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInBvc3QiLCJ1cmwiLCJtZXRob2QiLCJwYXJhbXMiLCJkb2dOYW1lUGFyYW0iLCJkb2dJZFBhcmFtIiwiX2lkIiwiZGF0YSIsIlVzZXJTdmMiLCJsb2dpbkZhaWxlZCIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZ2V0VGV4dENvbG91ciIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwic3ZjIiwiZ2V0VXNlciIsInZhbCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFlDQ0FELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxTQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNBSCxFQUFBSSxZQUFBRCxPQ0lBTixRQUFBQyxPQUFBLE9BQUFPLFVBQUEsZUFBQSxVQUFBLFNBQUFDLEdBRUEsT0FDQUMsUUFBQSxXQUNBQyxTQUFBLElBQ0FDLEtBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FFQSxHQUFBQyxHQUFB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aUJBQ0FELEtBQUEsY0FBQTlILFdBQUEsYUFBQStILFlBQUEsaUJBQ0FELEtBQUEsVUFBQTlILFdBQUEsWUFBQStILFlBQUEsa0JDUEFqSSxRQUFBQyxPQUFBLE9BQ0F3RyxRQUFBLFdBQUEsUUFBQSxTQUFBQyxHQUNBLEdBQUF3QixHQUFBdkIsSUFDQXVCLEdBQUFDLFFBQUEsV0FDQSxNQUFBekIsR0FBQUUsSUFBQSxlQUlBc0IsRUFBQVgsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFmLEdBQUFHLEtBQUEsaUJBQ0FXLFNBQUFBLEVBQUFDLFNBQUFBLElBQ0FDLEtBQUEsU0FBQVUsR0FHQSxNQUZBRixHQUFBRyxNQUFBRCxFQUFBaEIsS0FDQVYsRUFBQTRCLFNBQUFDLFFBQUFDLE9BQUEsVUFBQUosRUFBQWhCLEtBQ0FjLEVBQUFDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4nbmdSb3V0ZSdcbl0pXG5cbiIsIlxuLy9BbGxvd3MgdGhlIGxvZ2dlZGluIHVzZXIgdG8gYmUgZGlzcGxheWVkIG9uIHRvcCBSSFMgb2YgU1BBXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG4gICRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24gKF8sIHVzZXIpIHtcbiAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyXG4gIH0pXG59KSIsIi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vQW5ndWxhciBDb250cm9sbGVyIGZpbGUuICBcbi8vQ2FsbGVkIGJ5IHRoZSBIVE1MIHBhZ2UgdGhhdCBjb250YWlucyBBbmd1bGFyIHRhZ3Ncbi8vQ2FsbHMgdG8gZG9ncy5zdmMuanNcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG4vL05leHQgMiBcImRpcmVjdGl2ZXNcIiBhcmUgYW4gYXR0ZW1wdCB0byBnZXQgZGF0ZSBmb3JtYXR0aW5nIHRvIHdvcmtcbi8vVGhpcyB3YXMgdGFrZW4gZnJvbSBodHRwOi8vcGxua3IuY28vZWRpdC9OemVhdUlEVkhsZ2ViNnFGNzVoWD9wPXByZXZpZXdcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ21vRGF0ZUlucHV0JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcblx0XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWlyZTonXm5nTW9kZWwnLFxuICAgICAgICByZXN0cmljdDonQScsXG4gICAgICAgIGxpbms6ZnVuY3Rpb24gKHNjb3BlLCBlbG0sIGF0dHJzLCBjdHJsKSB7XG4gICAgICAgIFx0XG4gICAgICAgICAgICB2YXIgbW9tZW50ID0gJHdpbmRvdy5tb21lbnQ7XG4gICAgICAgICAgICB2YXIgZGF0ZUZvcm1hdCA9IGF0dHJzLm1vTWVkaXVtRGF0ZTtcbiAgICAgICAgICAgIGF0dHJzLiRvYnNlcnZlKCdtb0RhdGVJbnB1dCcsIGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRlRm9ybWF0ID09IG5ld1ZhbHVlIHx8ICFjdHJsLiRtb2RlbFZhbHVlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgZGF0ZUZvcm1hdCA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgIGN0cmwuJG1vZGVsVmFsdWUgPSBuZXcgRGF0ZShjdHJsLiRzZXRWaWV3VmFsdWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGN0cmwuJGZvcm1hdHRlcnMudW5zaGlmdChmdW5jdGlvbiAobW9kZWxWYWx1ZSkge1xuICAgICAgICAgICAgXHRcbiAgICAgICAgICAgICAgICBzY29wZSA9IHNjb3BlO1xuICAgICAgICAgICAgICAgIGlmICghZGF0ZUZvcm1hdCB8fCAhbW9kZWxWYWx1ZSkgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIHJldFZhbCA9IG1vbWVudChtb2RlbFZhbHVlKS5mb3JtYXQoZGF0ZUZvcm1hdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldFZhbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjdHJsLiRwYXJzZXJzLnVuc2hpZnQoZnVuY3Rpb24gKHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgXHQ7XG4gICAgICAgICAgICAgICAgc2NvcGUgPSBzY29wZTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZSA9IG1vbWVudCh2aWV3VmFsdWUsIGRhdGVGb3JtYXQpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoZGF0ZSAmJiBkYXRlLmlzVmFsaWQoKSAmJiBkYXRlLnllYXIoKSA+IDE5NTAgKSA/IGRhdGUudG9EYXRlKCkgOiBcIlwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnbW9DaGFuZ2VQcm94eScsIGZ1bmN0aW9uICgkcGFyc2UpIHtcblx0Y29uc29sZS5sb2coJ0luc2lkZSBtb0NoYW5nZVByb3h5Jyk7XG5cdFxuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVpcmU6J15uZ01vZGVsJyxcbiAgICAgICAgcmVzdHJpY3Q6J0EnLFxuICAgICAgICBsaW5rOmZ1bmN0aW9uIChzY29wZSwgZWxtLCBhdHRycywgY3RybCkge1xuICAgICAgICAgICAgdmFyIHByb3h5RXhwID0gYXR0cnMubW9DaGFuZ2VQcm94eTtcbiAgICAgICAgICAgIHZhciBtb2RlbEV4cCA9IGF0dHJzLm5nTW9kZWw7XG4gICAgICAgICAgICBzY29wZS4kd2F0Y2gocHJveHlFeHAsIGZ1bmN0aW9uIChuVmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5WYWwgIT0gY3RybC4kbW9kZWxWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgJHBhcnNlKG1vZGVsRXhwKS5hc3NpZ24oc2NvcGUsIG5WYWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlbG0uYmluZCgnYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJveHlWYWwgPSBzY29wZS4kZXZhbChwcm94eUV4cCk7XG4gICAgICAgICAgICAgICAgaWYoY3RybC4kbW9kZWxWYWx1ZSAhPSBwcm94eVZhbCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRwYXJzZShwcm94eUV4cCkuYXNzaWduKHNjb3BlLCBjdHJsLiRtb2RlbFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufSk7XG5cblxuLy9Mb2FkIHRoZSBkb2cgbGlzdCBvbnRvIHRoZSBzY3JlZW4gYWZ0ZXIgcHVsbGluZyBiYWNrIGZyb20gc2VydmljZS4gXG4vL0ltYWdlIGlzIHB1bGxlZCBiYWNrIHdpdGhpbiB0aGUgSlNPTiwgbm90aGluZyBzcGVjaWFsIGhhcyB0byBiZSBkb25lXG4vLyR3aW5kb3cgcGFyYW0gYWRkZWQgYnkgSkwgdG8gZW5hYmxlIHJlZGlyZWN0aW9uIHRvIGxvZ2luIHBhZ2UuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignRG9nc0N0cmwnLCBmdW5jdGlvbiAoJHdpbmRvdywgJHNjb3BlLCBEb2dzU3ZjKSB7XG4gICBcblx0RG9nc1N2Yy5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRvZ3MpIHtcblx0XHRcblx0XHRjb25zb2xlLmxvZygnVG90YWwgTnVtYmVyIG9mIGRvZ3MgaXM6ICcgKyBkb2dzLmxlbmd0aCk7XG5cdFx0JHNjb3BlLmRvZ3MgPSBkb2dzO1xuXHR9KS5lcnJvcihmdW5jdGlvbigpe1xuXHRcdGNvbnNvbGUubG9nKCdBbiBlcnJvciBvY2N1cmVkLCBzbyByZWRpcmVjdGluZyB0byBsb2dpbiBwYWdlJyk7XG5cdFx0JHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvIy9sb2dpbic7XG5cdH0pXG5cdCBcbn0pXG5cbiBcbi8vQWxsIGNyZWF0aW9uIG9mIGRvZ3MgZnJvbSBkYXRhIGVudHJ5IG9uIHRoZSBzY3JlZW5cbi8vVGhlIG5nLWNsaWNrIGNhbGxzIHRoZSBhZGREb2cgZnVuY3Rpb25cbi8vTm90ZSBJIGFkZGVkIHRoZSAkd2luZG93IHBhcmFtZXRlciB0byBhbGxvdyBmbGljayBiYWNrIHRvIGxpc3QgYWZ0ZXIgY3JlYXRpb25cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NyZWF0ZUN0cmwnLCBmdW5jdGlvbiAoJHdpbmRvdywgJHNjb3BlLCBEb2dDcmVhdGlvblN2Yykge1xuICAgXG5cdCRzY29wZS5hZGREb2cgPSBmdW5jdGlvbigpe1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdKdXN0IGFkZGluZyBhIGRvZycpO1xuXHRcdC8vY29uc29sZS5sb2coJyRzY29wZS5pbWFnZSA9ICcgKyAkc2NvcGUuaW1hZ2UpO1xuXHRcdGNvbnNvbGUubG9nKCckc2NvcGUuZG9nU3RhcnREYXRlJyArICRzY29wZS5kb2dTdGFydERhdGUpO1xuXHRcdC8vVGhlIGFib3ZlIGxpbmUgY29uZmlybXMgdGhhdCB0aGUgaW1hZ2UgcmVhZCBpbiB1cGxvYWQgaXMgYWxzbyB2aXNpYmxlIHdoZW4gYSBjb21lIHRvIFxuXHRcdC8vc3VibWl0IHRoZSBlbnRpcmUgZG9nIHBhZ2UuICA9PT4gTm93IG5lZWQgdG8gZ2V0IGltYWdlcyBhY3Jvc3MgdG8gdGhlIE5vZGUgc2VydmljZSBhbmQgdGhlbiBzYXZlZCBpbiBNb25nbyEhXG5cdFx0XG5cdFx0aWYoJHNjb3BlLmRvZ05hbWUpeyAgIC8vQ3JlYXRlIHRoZSBKU09OIG9iamVjdCB0byBzZW5kIHRvIHRoZSBzZXJ2aWNlIGNhbGxcblx0XHRcdERvZ0NyZWF0aW9uU3ZjLmNyZWF0ZSh7XG5cdFx0XHRcdGRvZ05hbWU6ICRzY29wZS5kb2dOYW1lLCBcblx0XHRcdFx0b3duZXJGaXJzdE5hbWU6ICRzY29wZS5vd25lckZpcnN0TmFtZSwgXG5cdFx0XHRcdG93bmVyTGFzdE5hbWU6ICRzY29wZS5vd25lclN1cm5hbWUsIFxuXHRcdFx0XHRkb2dET0I6JHNjb3BlLmRvZ0RPQixcblx0XHRcdFx0ZG9nU3RhcnREYXRlOiRzY29wZS5kb2dTdGFydERhdGUsXG5cdFx0XHRcdGRvZ1BpY3R1cmU6JHNjb3BlLmltYWdlXG5cdFx0XHR9KVxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKGRvZyl7XG5cdFx0XHRcdCR3aW5kb3cubG9jYXRpb24uaHJlZj0nLyMvJyAgXG5cdFx0XHRcdC8vSkwgYWRkZWQgdGhpcyBocmVmIHRvIHRha2UgdGhlIHVzZXIgYmFjayB0byBsaXN0IHBhZ2UuICBNYXkgYmUgYSBiZXR0ZXIgd2F5IG9mIGRvaW5nIHRoaXMuXG5cdFx0XHRcdC8vU29sdXRpb24gaXMgaGVyZTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yNzk0MTg3Ni9ob3ctdG8tcmVkaXJlY3QtdG8tYW5vdGhlci1wYWdlLXVzaW5nLWFuZ3VsYXItanNcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdC8vV2hlbiBhbiBlcnJvciBvY2N1cnMsIHRha2UgdXNlciB0byB0aGUgbG9naW4gcGFnZVxuXHRcdFx0XHRjb25zb2xlLmxvZygnQW4gZXJyb3Igb2NjdXJlZCwgc28gcmVkaXJlY3RpbmcgdG8gbG9naW4gcGFnZScpO1xuXHRcdFx0XHQkd2luZG93LmxvY2F0aW9uLmhyZWY9Jy8jL2xvZ2luJztcblx0XHRcdH0pXG5cdFx0fVxuXHR9XG59KVx0XG5cbi8vQWRkZWQgdGhpcyBjb250cm9sbGVyIHRvIGFsbG93IHVzZXIgdG8gcGljayBhIGZpbGUgZm9yIHRoZWlyIGRvZy5cbi8vQ29kZSB0YWtlbiBmcm9tIGhlcmU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTk5ODYxNzgvZGlzcGxheWluZy1hbi1pbWFnZS1hZnRlci11cGxvYWRpbmctaW4tYW5ndWxhci1qc1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1VwbG9hZEN0cmwnLCBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAgICAgICAgICRzY29wZS5pbWFnZSA9IFwiXCI7XG4gICAgICAgIH1dKS5kaXJlY3RpdmUoJ215VXBsb2FkJywgW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW1hZ2UgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvL09uIGNoYW5nZSBvZiAnc3RhdGUnLCByZWFkIGEgbmV3IGZpbGVcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChlbGVtWzBdLmZpbGVzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuXG5cblxuLy9Db250cm9sbGVyIHRvIHRha2UgdGhlIHNlbGVjdGVkIGRvZyBhbmQgc2hvdyBhbiBlZGl0IHBhZ2UgZm9yIHRoYXQgZG9nXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignRWRpdEN0cmwnLCBmdW5jdGlvbiAoJHdpbmRvdywgJGxvY2F0aW9uLCAkc2NvcGUsIERvZ3NHZXRPbmVTdmMsIERvZ3NVcGRhdGVTdmMpIHtcbiBcblx0Ly9UTyBETyAtIGlzIHRoaXMgdmFyaWFibGUgdGhyZWFkIHNhZmU/Pz9cblx0dmFyIHdhbGtzQXJlRWRpdGVkID0gZmFsc2U7XG5cdFxuXHQvL0dldCB0aGUgZG9nIG5hbWUgZnJvbSB0aGUgcXVlcnkgc3RyaW5nIC0gVE9ETyAtIG1ha2UgdGhpcyB0aGUgZG9nIHVuaXF1ZSBJRCBJbiBmdXR1cmUuXG5cdHZhciBzZWFyY2hPYmplY3QgPSAkbG9jYXRpb24uc2VhcmNoKCk7XG5cdFxuXHQvL1NlYXJjaCBkYXRhYmFzZSBmb3IgZG9nIHdpdGggdGhpcyBuYW1lXG5cdC8vU2hvdyBkb2cgZGV0YWlscyBvbiB0aGUgc2NyZWVuXG5cdFxuXHREb2dzR2V0T25lU3ZjLmZldGNoKHNlYXJjaE9iamVjdC5kb2dOYW1lKS5zdWNjZXNzKGZ1bmN0aW9uIChkb2cpIHtcblx0XHQgICRzY29wZS5kb2cgPSBkb2dcblx0XHR9KVxuXHRcdFxuXHRcdFxuXHQvL0FkZCBhIG5ldyB3YWxrIGxpbmUgdG8gdGhlIHRhYmxlXG5cdCRzY29wZS5hZGROZXdXYWxrID0gZnVuY3Rpb24oKSB7XG5cdFx0XG5cdFx0Ly9TZXQgZWRpdCBmbGFnIHNvIHRoYXQgc2NyZWVuIGNhbiBjaGFuZ2UgaGlnaGxpZ2h0IHN0YXR1c1xuXHRcdHdhbGtzQXJlRWRpdGVkID0gdHJ1ZTtcblx0XHRcblx0XHR2YXIgY3VycmVudFdhbGtDb3VudCA9ICRzY29wZS5kb2cud2Fsa3Mud2Fsa0FycmF5Lmxlbmd0aDtcblx0XHR2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuXHRcdFxuXHRcdCRzY29wZS5kb2cud2Fsa3Mud2Fsa0FycmF5LnB1c2goeyd3YWxrRGF0ZSc6dG9kYXksICd3YWxrVGltZSc6ICc2MCd9KTtcblxuXHQgICAgY29uc29sZS5sb2coJ2FkZGluZyBhIG5ldyB3YWxrLCBub3cgaGF2ZTogJyArIChjdXJyZW50V2Fsa0NvdW50KzEpKTtcblxuXHQgICAgXG5cdCAgfTtcblx0ICBcblx0Ly9SZW1vdmUgYSB3YWxrIGxpbmUgZnJvbSB0aGUgdGFibGVcblx0JHNjb3BlLnJlbW92ZVdhbGsgPSBmdW5jdGlvbihpbmRleCkge1xuXHRcdFxuXHRcdC8vU2V0IGVkaXQgZmxhZyBzbyB0aGF0IHNjcmVlbiBjYW4gY2hhbmdlIGhpZ2hsaWdodCBzdGF0dXNcblx0XHR3YWxrc0FyZUVkaXRlZCA9IHRydWU7XG5cdFx0XG5cdCAgICBjb25zb2xlLmxvZygnR29pbmcgdG8gcmVtb3ZlIHdhbGsgZnJvbSBsaXN0IGF0IHBvc2l0aW9uOiAnICsgaW5kZXgpO1xuXHRcdFxuXHRcdCRzY29wZS5kb2cud2Fsa3Mud2Fsa0FycmF5LnNwbGljZShpbmRleCwgMSk7XG5cdFx0XG5cdCAgfTtcblx0ICBcblx0ICBcblx0Ly9UTyBETyAtIG5lZWQgYSB3YXkgdG8gZGV0ZXJtaW5lIGlmIGFueSBvZiB0aGUgd2FsayBzdGF0ZSBoYXMgY2hhbmdlZCwgYW5kIHJldHVybiB0cnVlIG9ubHkgaWYgaXQgaGFzLlxuXHQvL0kuZS4gaWYgdGhlIGRhdGUgaGFzIGJlZW4gZWRpdGVkLCBidXQgbm8gbmV3IG9yIHJlbW92ZWQgd2Fsa3MsIHRoZW4gdGhpcyBzaG91bGQgcmV0dXJuIHRydWUuXG5cdCRzY29wZS5oYXNVcGRhdGVkV2FsayA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICByZXR1cm4gd2Fsa3NBcmVFZGl0ZWQ7ICBcblx0ICAgIH07XG5cdCAgICBcblx0ICAgIFxuXHQkc2NvcGUuZ2V0Um93Q29sb3VyID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgIGlmKHdhbGtzQXJlRWRpdGVkID09IHRydWUpe1xuXHQgICAgICAgIFx0IHJldHVybiB7J2JhY2tncm91bmQtY29sb3InOiBcInBpbmtcIn07XG5cdCAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgXHQgcmV0dXJuIHtjb2xvcjogXCJibHVlXCJ9O1xuXHQgICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICBcblx0JHNjb3BlLnNhdmVXYWxrcyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICBcblx0XHRcdGNvbnNvbGUubG9nKCdOZWVkIHRvIHNhdmUgdGhlIHdhbGtzIGZvciBkb2c6ICcgKyAkc2NvcGUuZG9nLmRvZ05hbWUpO1xuXHRcdFx0XG5cdFx0XHREb2dzVXBkYXRlU3ZjLnVwZGF0ZSgkc2NvcGUuZG9nKS5zdWNjZXNzKGZ1bmN0aW9uIChkb2cpIHtcblx0XHRcdFx0ICAkc2NvcGUuZG9nID0gZG9nXG5cdFx0XHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRvZyl7XG5cdFx0XHRcdFx0Ly9BZ2FpbiwgdGhlIHRyaWNrIHRvIHJlZGlyZWN0IGZyb20gYSBidXR0b24gY2xpY2ssIGJhY2sgdG8gdGhlIGxpc3QgcGFnZS4gIEFsc29cblx0XHRcdFx0XHQvL05lZWRlZCB0byBhZGQgdGhlICR3aW5kb3cgcGFyYW1ldGVyIHRvIHRoZSBjb250cm9sbGVyIGZ1bmN0aW9uIGFib3ZlXG5cdFx0XHRcdFx0Ly9UT0RPIC0gbWFrZSBpdCByZWxvYWQgdGhlIHNhbWUgZWRpdCBwYWdlIHdpdGggdGhlIHVwZGF0ZWQgZGV0YWlscywgZG9uJ3Qgd2FudCB0byBuYXZpZ2F0ZSBhd2F5XG5cdFx0XHRcdFx0JHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvIy8nIFxuXHRcdFx0XHR9KVxuXHQgICAgfTsgIFxufSlcbiBcbi8vQ29udHJvbGxlciB0byBkZWxldGUgdGhlIHNlbGVjdGVkIGRvZyBmcm9tIHRoZSBkYXRhYmFzZVxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0RlbGV0ZUN0cmwnLCBmdW5jdGlvbiAoJGxvY2F0aW9uLCAkc2NvcGUsIERvZ3NEZWxldGVTdmMpIHtcbiBcblx0Ly9HZXQgdGhlIGRvZyBJRCBmcm9tIHRoZSBxdWVyeSBzdHJpbmdcblx0dmFyIHNlYXJjaE9iamVjdCA9ICRsb2NhdGlvbi5zZWFyY2goKTtcblx0XG5cdC8vUmVtb3ZlIHRoZSBkb2cgZnJvbSB0aGUgZGF0YWJhc2Vcblx0RG9nc0RlbGV0ZVN2Yy5kZWxldGUoc2VhcmNoT2JqZWN0LmRvZ0lkKS5zdWNjZXNzKGZ1bmN0aW9uIChkb2cpIHtcblx0XHQgICRzY29wZS5kb2cgPSBkb2dcblx0XHR9KVxuXHRcbn0pXG5cblxuIiwiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy9Bbmd1bGFyIFNlcnZpY2VzIGZpbGUuICBcbi8vQ2FsbGVkIGJ5IGRvZy5jdHJsLmpzIGZpbGVcbi8vQ2FsbHMgdG8gSFRUUCBzZXJ2aWNlIGluIGRvZ3MuanMgKEkuRSBhIFJFU1RGdWwgSFRUUCBjYWxsIHRvIE5vZGUpXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8vR2V0IHRoZSBsaXN0IG9mIGRvZ3MgdG8gc2hvdyBvbiB0aGUgc2NyZWVuXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5zZXJ2aWNlKCdEb2dzU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9kb2dzJylcbiAgfVxufSlcblxuXG5cbi8vU2F2ZSBhIG5ldyBkb2cgdG8gdGhlIEhUVFAgcG9zdCBzZXJ2aWNlXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykuc2VydmljZSgnRG9nQ3JlYXRpb25TdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0XG4gIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24gKGRvZykge1xuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2RvZycsIGRvZylcbiAgICB9IFxufSlcblxuXG4vL0dldCBhIHNpbmdsZSBkb2cgZnJvbSB0aGUgc3RvcmUgYnkgbmFtZVxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnNlcnZpY2UoJ0RvZ3NHZXRPbmVTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uIChkb2dOYW1lKSB7XG5cdCAgXG5cdGNvbnNvbGUubG9nKCdJbnNpZGUgdGhlIGFuZ3VsYXIgc2VydmljZSBsYXllci4gIEhhdmUgYmVlbiBhc2tlZCB0byBnZXQgZG9nOiAnICsgZG9nTmFtZSk7IFxuXHQgXG5cdHJldHVybiAkaHR0cCh7XG5cdFx0dXJsOiAnL2FwaS9kb2cnLCBcblx0XHRtZXRob2Q6IFwiR0VUXCIsXG5cdFx0cGFyYW1zOntkb2dOYW1lUGFyYW06ZG9nTmFtZX1cblx0fSlcbiAgfVxufSlcblxuXG4vL0RlbGV0ZSBhIHNpbmdsZSBkb2cgZnJvbSB0aGUgc3RvcmUgYnkgSURcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5zZXJ2aWNlKCdEb2dzRGVsZXRlU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gXG5cdHRoaXMuZGVsZXRlID0gZnVuY3Rpb24gKGRvZ0lkKSB7XG5cdCAgXG5cdGNvbnNvbGUubG9nKCdJbnNpZGUgdGhlIGFuZ3VsYXIgc2VydmljZSBsYXllci4gIEhhdmUgYmVlbiBhc2tlZCB0byBkZWxldGUgZG9nOiAnICsgZG9nSWQpOyBcblx0IFxuXHRyZXR1cm4gJGh0dHAoe1xuXHRcdHVybDogJy9hcGkvZG9nJywgXG5cdFx0bWV0aG9kOiBcIkRFTEVURVwiLFxuXHRcdHBhcmFtczp7ZG9nSWRQYXJhbTpkb2dJZH1cblx0fSlcblx0XG4gIH1cbn0pXG5cblxuLy9VcGRhdGUgYSBkb2cgYWxyZWFkeSBpbiB0aGUgZGF0YWJhc2VcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5zZXJ2aWNlKCdEb2dzVXBkYXRlU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gXG5cdFxuICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uIChkb2cpIHtcblx0ICBcblx0XHRjb25zb2xlLmxvZygnSW5zaWRlIHRoZSBhbmd1bGFyIHNlcnZpY2UgbGF5ZXIuICBIYXZlIGJlZW4gYXNrZWQgdG8gc2F2ZSBkb2c6ICcgKyBkb2cuZG9nTmFtZSk7IFxuXHRcdCBcblx0XHQvL1RyaWNrIGhlcmUgd2FzIHRvIHBhc3MgdGhlIGRvZyBhY3Jvc3MgdXNpbmcgdGhlIFwiZGF0YVwiIHRhZ1xuXHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHR1cmw6ICcvYXBpL2RvZy8nK2RvZy5faWQsIFxuXHRcdFx0bWV0aG9kOiBcIlBVVFwiLFxuXHRcdFx0ZGF0YTpkb2dcblx0XHR9KVxuXHQgIH1cblx0IFxuXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdFxuICB2YXIgbG9naW5GYWlsZWQgPSBmYWxzZTtcblx0XG4gICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICBVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKVxuICAgIH0pXG4gIH1cbiAgXG4gIC8vQWRkZWQgYnkgSkwgdG8gYWxsb3cgY2hhbmdlIG9mIGNvbG91ciB3aGVuIGxvZ2luIGZhaWxzLiAgTmVlZCB0byB3b3JrIG91dCBob3cgdG8gdHJhcCBsb2dpbiBmYWlsdXJlXG4gIC8vYWJvdmUgZm9yIHRoaXMgdG8gYmUgdXNlZnVsIVxuXHQkc2NvcGUuZ2V0VGV4dENvbG91ciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZihsb2dpbkZhaWxlZCA9PSB0cnVlKXtcbiAgICAgICBcdCByZXR1cm4geydiYWNrZ3JvdW5kLWNvbG9yJzogJ3BpbmsnfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICBcdCByZXR1cm4geydiYWNrZ3JvdW5kLWNvbG9yJzogJ3doaXRlJ307XG4gICAgICAgIH1cbiAgIH07XG4gIFxufSkiLCIvLy8vLy8vLy8vLy8vL1xuLy8gRGV0ZXJtaW5lcyB3aGljaCBIVE1MIHRvIGxvYWQgZGVwZW5kaW5nIG9uIHdoaWNoIG5hdmlnYXRpb24gbGluayB0aGUgdXNlciBoYXMgY2xpY2tlZFxuLy8gTGlua3MgdGhlIEhUTUwgcGFnZSB0byB0aGUgQW5ndWxhciBjb250cm9sbGVyXG5cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAkcm91dGVQcm92aWRlclxuICAud2hlbignLycsIHsgY29udHJvbGxlcjogJ0RvZ3NDdHJsJywgdGVtcGxhdGVVcmw6ICdkb2dMaXN0Lmh0bWwnIH0pXG4gIC53aGVuKCcvY3JlYXRlRG9nJywgeyBjb250cm9sbGVyOiAnQ3JlYXRlQ3RybCcsIHRlbXBsYXRlVXJsOiAnZG9nQ3JlYXRpb24uaHRtbCcgfSlcbiAgLndoZW4oJy9lZGl0RG9nJywgeyBjb250cm9sbGVyOiAnRWRpdEN0cmwnLCB0ZW1wbGF0ZVVybDogJ2RvZ0VkaXQuaHRtbCd9KVxuICAgLndoZW4oJy9kZWxldGVEb2cnLCB7IGNvbnRyb2xsZXI6ICdEZWxldGVDdHJsJywgdGVtcGxhdGVVcmw6ICdkb2dMaXN0Lmh0bWwnfSlcbiAgIC53aGVuKCcvdXBkYXRlRG9nJywgeyBjb250cm9sbGVyOiAnVXBkYXRlQ3RybCcsIHRlbXBsYXRlVXJsOiAnZG9nTGlzdC5odG1sJ30pXG4gICAud2hlbignL2xvZ2luJywgeyBjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyB9KVxufSlcblxuIiwiXG4vL0p1c3QgbmVlZCB0byBzZW5kIHVwIHRoZSBYLUF1dGggaGVhZGVyIG9uIHRoZSBwb3N0IGNyZWF0aW9uIHJlcXVlc3QuIFxuLy9Zb3UgY291bGQgYWRkIHRoaXMgZGlyZWN0bHkgdG8gdGhlIHBvc3RzIGNvbnRyb2xsZXIsIGJ1dCB0aGUgYmV0dGVyIFxuLy93YXkgd291bGQgYmUgdG8gZ2xvYmFsbHkgYWRkIHRoYXQgaGVhZGVyIGZvciBhbGwgcmVxdWVzdHMgc28geW91IHdvbuKAmXQgXG4vL2hhdmUgdG8ga2VlcCByZW1lbWJlcmluZyB0byBkbyB0aGF0LiBcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xuICB2YXIgc3ZjID0gdGhpc1xuICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgIH1cblxuICAvL0xvZ2luIGZ1bmN0aW9uXG4gIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgfSkudGhlbihmdW5jdGlvbiAodmFsKSB7XG4gICAgICBzdmMudG9rZW4gPSB2YWwuZGF0YVxuICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdmFsLmRhdGFcbiAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXG4gICAgfSlcbiAgfVxuICBcbn0pIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9